<div class="layui-collapse" lay-filter="search-filter">
    <div class="layui-colla-item">
        <h2 class="layui-colla-title">查找条件</h2>
        <div class="layui-colla-content layui-show">
            <form class="layui-form" action="" id="" lay-filter="">
                <div class="layui-form-item fled-flex-start">
                    <div class="layui-input-inline">
                        <button class="layui-btn" lay-submit lay-filter="formDemo">查找</button>
                        <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                    </div>
                    <div class="layui-input-inline">
                        <p style="color: red;">
                            <i class="layui-icon layui-icon-tips"></i>
                            <span>双击行可以编辑员工信息</span>
                        </p>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">员工编号</label>
                    <div class="layui-input-inline">
                        <input type="text" name="staff_code" placeholder="" autocomplete="off" class="layui-input">
                    </div>
                    <label class="layui-form-label">员工姓名</label>
                    <div class="layui-input-inline">
                        <input type="text" name="staff_name" placeholder="" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">员工状态</label>
                    <div class="layui-input-inline">
                        <select name="is_disable">
                            <option value=""></option>
                            <option value="0">正常</option>
                            <option value="1">禁用</option>
                        </select>
                    </div>
                    <label class="layui-form-label">手机号码</label>
                    <div class="layui-input-inline">
                        <input type="text" name="phone" placeholder="" autocomplete="off" class="layui-input">
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- 工具栏 -->
<script type="text/html" id="toolbar">
    <div class="layui-btn-group">
	  <button class="layui-btn layui-btn-primary layui-btn-sm" lay-event="add" id="add-btn" title="添加员工">
	    <i class="layui-icon">&#xe654;</i>
	  </button>
	  <button class="layui-btn layui-btn-primary layui-btn-sm" lay-event="edit" id="edit-btn" title="修改员工">
	    <i class="layui-icon">&#xe642;</i>
	  </button>
	</div>
</script>
<!-- 進貨單表格 -->
<table id="list" lay-filter="list"></table>
<!-- 操作栏 -->
<script type="text/html" id="ctrlTpl">
    <div class="">
  	{{#  if(d.status == 0){ }}
	    <button class="layui-btn layui-btn-xs edit-order" order_id="{{ d.id }}">编辑商品项</button>
	{{#  } }} 

	{{#  if(d.status != 0){ }}
	    <button class="layui-btn layui-btn-disabled layui-btn-xs">编辑商品项</button>
	{{#  } }}
  </div>
</script>
<!-- 引入查找条件操作的js -->
<include file="depot@base/collapse_ctrl" />
<script type="text/javascript">
// 选中的行
var selectRow;

// 时间对象
var laydate = layui.laydate;

// 开始时间
laydate.render({
    elem: '#start-date', //指定元素
});

// 结束时间
laydate.render({
    elem: '#end-date', //指定元素
});


// 表单提交
var form = layui.form;
form.on('submit(formDemo)', function(data) {
    // 重新获取表格数据
    initTable(data.field);
    return false;
});


// 初始化表格
initTable();

// 初始化表格
function initTable(params) {

    var table = layui.table;

    // 链接url
    let url = '/staff/staff/index?';

    // 拼接参数
    if (undefined !== params) {
        for (let i in params) {
            if (params[i] !== '') {
                url += i + '=' + params[i] + '&';
            }
        }
    }

    //第一个实例
    table.render({
        elem: '#list',
        height: tableNormalHeight + 'px',
        url: url //数据接口
            ,
        toolbar: '#toolbar'
            // ,defaultToolbar: ['filter', 'print', 'exports']
            ,
        page: true //开启分页
            ,
        headers: {
            ctrl: SHOP_DATA
        },
        done: function(res, curr, count) {
            // 表格初始化回调
            tableDoneCallBack();
        },
        cols: [
            [ //表头
                { type: 'radio', fixed: 'left' }, { field: 'staff_code', title: '编号', width: 150 }, { field: 'staff_account', title: '账号', width: 100 }, { field: 'staff_name', title: '名称', width: 100 }, { field: 'phone', title: '手机', width: 120 }, { field: 'title', title: '角色', width: 120 }, {
                    field: 'is_disable',
                    title: '状态',
                    width: 80,
                    templet: function(row) {
                        if (row.is_disable) {
                            return '<span style="color:red;">禁用</span>';
                        } else {
                            return '<span style="color:rgb(0, 150, 136);">正常</span>'
                        }
                    }
                }, { field: 'create_time', title: '加入时间', width: 180 }
            ]
        ]
    });

    // 选中单选框
    table.on('radio(list)', function(obj) {

        if (obj.checked) {
            // 保存选中的行
            selectRow = obj.data;
        } else {
            selectRow = null;
        }

    });

    //监听行双击事件
    table.on('rowDouble(list)', function(obj) {
        //obj 同上
        // 打开进货单商品列表
        location.href = '/staff/staff/edit_staff?id=' + obj.data.id;
    });

      //监听工具栏事件
  table.on ('toolbar(list)', function (obj) {
    const rows = table.checkStatus(obj.config.id);
    const data = rows.data[0] || undefined
    if (obj.event != 'add' && !data) {
      layer.msg('请选择要操作的行')
      return false
    }
    switch (obj.event){
      case 'add':
        layer.open({
          title: '添加员工',
          type: 2,
          content: '/staff/staff/add_staff',
          area: ['500px', '500px'],
          btn: false
        })
        break;
      case 'edit':
        layer.open({
          title: '修改员工',
          type: 2,
          content: '/staff/staff/edit_staff?id=' + data.id,
          area: ['500px', '500px'],
          btn: false
        })
        break;
      case 'delete':
        layer.msg('删除');
        break;
    }
  })

}


/**
 * [tableDoneCallBack 表格初始化完成后，回调方法]
 * @return {[type]} [description]
 */
function tableDoneCallBack() {


}
</script>